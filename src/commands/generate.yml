description: >
  Generates an SBOM on any number of targets (paths to source code, containers, etc.)
parameters:
  source:
    type: string
    description: "comma separated list of targets to generate SBOM for"
  output:
    type: string
    description: "file path to write SBOM to"
    default: "sbom.json"
  format:
    type: string
    description: "set the output format of the SBOM"
    default: "cyclonedx-json"
  source_name:
    type: string
    description: "set the name of the target source"
    default: ""
  source_version:
    type: string
    description: "set the version of the target source"
    default: ""
  generator:
    type: string
    description: "set the generator to use"
    default: ""
  args:
    type: string
    description: "set the arguments to pass to the generator"
    default: ""
  publish:
    type: boolean
    description: "publish the SBOM to the Manifest platform"
    default: true
steps:
  - run:
      environment:
        MANIFEST_SOURCE: <<parameters.source>>
        MANIFEST_OUTPUT: <<parameters.output>>
        MANIFEST_FORMAT: <<parameters.format>>
        MANIFEST_SOURCE_NAME: <<parameters.source_name>>
        MANIFEST_SOURCE_VERSION: <<parameters.source_version>>
        MANIFEST_GENERATOR: <<parameters.generator>>
        MANIFEST_ARGS: <<parameters.args>>
        MANIFEST_PUBLISH: <<parameters.publish>>
      name: Generate SBOM
      command: <<include(scripts/generate.sh)>>
